# MetronomeMegaMax 開発進捗管理

## 凡例
- [ ] 未着手
- [~] 進行中
- [x] 完了
- [!] ブロック中（理由を記載）

---

## Phase 0: プロジェクトセットアップ
目標: 開発環境の構築とプロジェクト初期化

### 0.1 開発環境構築
- [ ] Node.js / npm のバージョン確認・インストール
- [ ] React Native CLI のインストール
- [ ] Xcode のインストール・設定（iOS開発用）
- [ ] iOS Simulator の設定

### 0.2 プロジェクト初期化
- [ ] React Native プロジェクト作成（TypeScript テンプレート）
- [ ] React Native for Web の設定
- [ ] ESLint / Prettier の設定
- [ ] Git リポジトリの初期化
- [ ] .gitignore の設定

### 0.3 ディレクトリ構造の設計
- [ ] src/ 以下のフォルダ構成を決定
- [ ] components/, screens/, hooks/, utils/, services/ 等の作成
- [ ] 多言語対応（i18n）のフォルダ構成

---

## Phase 1: 基盤実装
目標: 共通コンポーネントとナビゲーション

### 1.1 レイアウト基盤
- [ ] レスポンシブレイアウトのブレークポイント定義（1440px, 1280px, 1120px）
- [ ] メインレイアウトコンポーネント（Web横並び / スライダー切り替え）
- [ ] ヘッダーコンポーネント（Web版）
- [ ] ヘッダーコンポーネント（iOS版 / 1120px未満）
- [ ] 広告配置用コンポーネント（プレースホルダー）

### 1.2 共通UIコンポーネント
- [ ] ボタンコンポーネント（START, SAVE, 加算ボタン等）
- [ ] ドロップダウン/セレクターコンポーネント
- [ ] ポップアップ/モーダルコンポーネント
- [ ] スライダー（スワイプ切り替え）コンポーネント

### 1.3 多言語対応（i18n）
- [ ] i18n ライブラリの導入（react-i18next 等）
- [ ] 日本語翻訳ファイル作成
- [ ] 英語翻訳ファイル作成
- [ ] スペイン語翻訳ファイル作成
- [ ] 言語切り替えドロップダウンの実装

---

## Phase 2: メトロノーム機能
目標: コア機能であるメトロノームの実装

### 2.1 メトロノームUI
- [ ] メトロノームパネルのレイアウト
- [ ] BPM表示（大きな数字）
- [ ] ±ボタンによるBPM調整
- [ ] 振り子アニメーションの実装
- [ ] ビートインジケーター（拍子に応じた丸印）の実装
- [ ] 拍子セレクター（ドロップダウン）
- [ ] アクセントセレクター（ドロップダウン）
- [ ] START/STOPボタン

### 2.2 メトロノームオーディオエンジン（iOS）
- [ ] Swift ネイティブモジュールの作成
- [ ] AVAudioEngine を使用したオーディオ再生
- [ ] Look-ahead スケジューリングの実装
- [ ] BPM変更時のリアルタイム反映
- [ ] 拍子変更時の対応
- [ ] アクセントパターンの実装（3パターン）
- [ ] React Native との Bridge 実装

### 2.3 メトロノームオーディオエンジン（Web）
- [ ] Web Audio API を使用したオーディオ再生
- [ ] AudioContext によるスケジューリング
- [ ] Look-ahead パターンの実装
- [ ] BPM/拍子/アクセントの対応

### 2.4 メトロノームクリック音
- [ ] クリック音の音声ファイル準備（通常/アクセント）
- [ ] 音声ファイルのバンドル設定

---

## Phase 3: タイマー機能
目標: カウントダウンタイマーの実装

### 3.1 タイマーUI
- [ ] タイマーパネルのレイアウト
- [ ] 時間表示（HH:MM:SS）
- [ ] 加算ボタン群（30秒/1分/3分/5分/10分/30分）
- [ ] 「時間を選択」ドロップダウン
- [ ] START/一時停止ボタン
- [ ] SAVEボタン

### 3.2 タイマーロジック
- [ ] カウントダウンロジックの実装
- [ ] 一時停止/再開機能
- [ ] リセット機能
- [ ] 終了時アラーム音の再生

---

## Phase 4: 音源再生機能
目標: 音源ファイルの再生とA-Bリピート

### 4.1 音源再生UI
- [ ] 音源再生パネルのレイアウト
- [ ] 15秒戻る/進むボタン
- [ ] 再生/一時停止ボタン
- [ ] シークバー
- [ ] A-B区間設定入力欄
- [ ] LOOPボタン
- [ ] 再生速度セレクター
- [ ] ファイル選択ボタン
- [ ] アップロードボタン
- [ ] SAVEボタン

### 4.2 音源再生ロジック（iOS）
- [ ] AVAudioPlayer を使用した音源再生
- [ ] シーク機能
- [ ] 15秒スキップ機能
- [ ] メトロノームとの同時再生対応

### 4.3 音源再生ロジック（Web）
- [ ] Web Audio API / HTML5 Audio による再生
- [ ] シーク機能
- [ ] 15秒スキップ機能

### 4.4 A-Bリピート機能（有料版）
- [ ] A点/B点の設定ロジック
- [ ] ループ再生の実装
- [ ] LOOPボタンによるオン/オフ切り替え

### 4.5 再生速度変更（有料版）
- [ ] 再生速度変更ロジック（0.5x〜2x）
- [ ] ピッチ補正（速度変更時に音程を維持）

### 4.6 ファイル選択
- [ ] iOS: UIDocumentPickerViewController の実装
- [ ] Web: input type="file" の実装
- [ ] 対応フォーマット（mp3, wav）のフィルタリング
- [ ] エラーハンドリング

---

## Phase 5: 認証・課金
目標: ユーザー認証と課金システムの実装

### 5.1 Firebase Authentication
- [ ] Firebase SDK の導入
- [ ] Google Sign-In の実装（iOS）
- [ ] Google Sign-In の実装（Web）
- [ ] ログイン状態の管理（Context/State）
- [ ] ログインポップアップUI

### 5.2 課金システム（iOS）
- [ ] App Store Connect での In-App Purchase 設定
- [ ] RevenueCat または StoreKit の導入
- [ ] 購入フローの実装
- [ ] 購入状態の復元
- [ ] 課金ポップアップUI

### 5.3 課金システム（Web）
- [ ] Stripe SDK の導入
- [ ] Stripe Checkout / Payment Link の実装
- [ ] Webhook による課金状態の同期
- [ ] 課金ポップアップUI

### 5.4 課金状態管理
- [ ] Firestore での課金状態保存
- [ ] プラットフォーム間での課金状態同期
- [ ] 有料機能のアクセス制御実装

### 5.5 解約機能
- [ ] iOS: App Store 経由の解約案内
- [ ] Web: Stripe Customer Portal の実装
- [ ] 解約ポップアップUI

---

## Phase 6: プリセット・クラウド同期
目標: プリセット保存とクラウド同期機能

### 6.1 Firestore データ設計
- [ ] ユーザーデータのコレクション設計
- [ ] BPMプリセットのスキーマ設計
- [ ] タイマープリセットのスキーマ設計
- [ ] ループポイントのスキーマ設計

### 6.2 BPMプリセット保存（有料版）
- [ ] プリセット保存ロジック
- [ ] プリセット読み込みロジック
- [ ] プリセット削除ロジック
- [ ] 「BPMを選択」ドロップダウンとの連携

### 6.3 タイマープリセット保存（有料版）
- [ ] プリセット保存ロジック
- [ ] プリセット読み込みロジック
- [ ] 「時間を選択」ドロップダウンとの連携

### 6.4 ループポイント保存（有料版）
- [ ] Firebase Storage への音源アップロード
- [ ] アップロード進捗表示
- [ ] ファイルサイズ検証（20MB制限）
- [ ] Firestore へのメタデータ保存
- [ ] ループポイント読み込み・キャッシュ

---

## Phase 7: 広告
目標: 広告の実装

### 7.1 iOS広告（AdMob）
- [ ] AdMob SDK の導入
- [ ] バナー広告の実装（下部）
- [ ] 有料版での広告非表示

### 7.2 Web広告（AdSense）
- [ ] AdSense コードの設置
- [ ] サイドバー広告（160x600）の実装
- [ ] 下部広告（728x90）の実装
- [ ] レスポンシブ対応（ブレークポイントに応じた表示切り替え）
- [ ] 有料版での広告非表示

---

## Phase 8: バックグラウンド再生（iOS有料版）
目標: バックグラウンドでのメトロノーム再生

### 8.1 バックグラウンド対応
- [ ] Info.plist での Background Modes 設定
- [ ] AVAudioSession の設定（.playback）
- [ ] バックグラウンド時のタイミング精度テスト

---

## Phase 9: テスト
目標: 品質保証

### 9.1 ユニットテスト
- [ ] メトロノームロジックのテスト
- [ ] タイマーロジックのテスト
- [ ] 音源再生ロジックのテスト
- [ ] 課金状態管理のテスト

### 9.2 E2Eテスト
- [ ] メトロノーム操作フローのテスト
- [ ] タイマー操作フローのテスト
- [ ] 音源再生フローのテスト
- [ ] 課金フローのテスト（サンドボックス）

### 9.3 パフォーマンステスト
- [ ] メトロノーム精度測定（±1ms以内）
- [ ] メモリ使用量の確認
- [ ] 起動時間の計測（3秒以内）

### 9.4 クロスプラットフォームテスト
- [ ] iOS実機テスト
- [ ] Web（Chrome）テスト
- [ ] Web（Safari）テスト
- [ ] Web（Firefox）テスト

---

## Phase 10: リリース準備
目標: アプリのリリース

### 10.1 iOS リリース
- [ ] App Store Connect での App 情報入力
- [ ] スクリーンショット・プレビュー動画の作成
- [ ] プライバシーポリシーの作成
- [ ] 利用規約の作成
- [ ] 審査提出

### 10.2 Web リリース
- [ ] ドメイン取得・DNS設定
- [ ] ホスティング設定（Firebase Hosting / Vercel 等）
- [ ] SSL証明書の設定
- [ ] 本番環境へのデプロイ
- [ ] Google Search Console 登録

### 10.3 ドキュメント
- [ ] ユーザー向けヘルプページの作成
- [ ] FAQ の作成

---

## 現在のステータス

**現在のフェーズ:** Phase 0: プロジェクトセットアップ
**最終更新:** 2026-02-22
**ブロッカー:** なし

---

## メモ・注意事項

- メトロノームの精度が最優先。パフォーマンスに影響する機能は慎重に検討
- iOS版とWeb版で実装方法が異なる箇所が多いため、Platform別の実装管理が重要
- 有料版機能は課金状態チェックを忘れずに
